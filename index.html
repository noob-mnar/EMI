<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>VIP EMI Calculator</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    :root {
      --bg: #f0f2f5;
      --text: #333;
      --card: #fff;
    }
    [data-theme="dark"] {
      --bg: #121212;
      --text: #f0f0f0;
      --card: #1e1e1e;
    }
    body {
      font-family: 'Poppins', sans-serif;
      background: var(--bg);
      color: var(--text);
      margin: 0;
      padding: 20px;
      transition: all 0.3s ease;
    }
    .container {
      max-width: 800px;
      margin: auto;
    }
    .calculator, .comparison {
      background: var(--card);
      padding: 20px;
      border-radius: 12px;
      margin-bottom: 30px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    }
    h2 {
      text-align: center;
    }
    .input-group {
      margin: 15px 0;
    }
    label {
      font-weight: 600;
    }
    input[type="range"] {
      width: 100%;
    }
    .results, .comparison-results {
      margin-top: 15px;
      padding: 10px;
      background: #eaeaea;
      border-radius: 10px;
    }
    .buttons {
      margin-top: 20px;
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      justify-content: space-between;
    }
    button {
      padding: 10px 15px;
      font-weight: 600;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      background-color: #007bff;
      color: white;
    }
    canvas {
      margin-top: 20px;
    }
    @media (max-width: 600px) {
      .buttons {
        flex-direction: column;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="calculator">
      <h2>EMI Calculator</h2><div class="input-group">
    <label>Loan Amount (Rs.)</label>
    <input type="range" id="amount" min="10000" max="1000000" step="1000" value="500000">
    <div id="amountVal">500000</div>
  </div>
  <div class="input-group">
    <label>Interest Rate (%)</label>
    <input type="range" id="rate" min="1" max="15" step="0.1" value="7.5">
    <div id="rateVal">7.5</div>
  </div>
  <div class="input-group">
    <label>Tenure (months)</label>
    <input type="range" id="tenure" min="12" max="360" step="1" value="120">
    <div id="tenureVal">120</div>
  </div>

  <div class="results">
    <p id="emi">EMI: Rs. 0</p>
    <p id="totalInterest">Total Interest: Rs. 0</p>
    <p id="totalPayment">Total Payment: Rs. 0</p>
  </div>

  <div class="buttons">
    <button onclick="toggleTheme()">Toggle Theme</button>
    <button onclick="exportPDF()">Export PDF</button>
    <button onclick="sendEmail()">Email Result</button>
  </div>

  <canvas id="breakdownChart" height="150"></canvas>
</div>

<div class="comparison">
  <h2>Loan Comparison</h2>
  <div class="input-group">
    <label>Loan 1: Amount / Rate / Tenure</label>
    <input type="text" id="l1" placeholder="e.g. 500000, 7.5, 120">
  </div>
  <div class="input-group">
    <label>Loan 2: Amount / Rate / Tenure</label>
    <input type="text" id="l2" placeholder="e.g. 600000, 8, 100">
  </div>
  <div class="buttons">
    <button onclick="compareLoans()">Compare</button>
  </div>
  <div class="comparison-results" id="comparisonResults"></div>
</div>

  </div>  <script>
    const amount = document.getElementById("amount");
    const rate = document.getElementById("rate");
    const tenure = document.getElementById("tenure");
    const aVal = document.getElementById("amountVal");
    const rVal = document.getElementById("rateVal");
    const tVal = document.getElementById("tenureVal");
    const emiText = document.getElementById("emi");
    const interestText = document.getElementById("totalInterest");
    const paymentText = document.getElementById("totalPayment");

    function calculateEMI(P, R, N) {
      R = R / 12 / 100;
      const emi = (P * R * Math.pow(1 + R, N)) / (Math.pow(1 + R, N) - 1);
      const total = emi * N;
      return [emi, total - P, total];
    }

    function updateEMI() {
      const P = +amount.value;
      const R = +rate.value;
      const N = +tenure.value;
      aVal.innerText = P;
      rVal.innerText = R;
      tVal.innerText = N;
      const [emi, interest, total] = calculateEMI(P, R, N);
      emiText.innerText = `EMI: Rs. ${emi.toFixed(2)}`;
      interestText.innerText = `Total Interest: Rs. ${interest.toFixed(2)}`;
      paymentText.innerText = `Total Payment: Rs. ${total.toFixed(2)}`;
      updateChart(emi * N, P);
    }

    amount.oninput = rate.oninput = tenure.oninput = updateEMI;

    function toggleTheme() {
      const current = document.documentElement.getAttribute("data-theme");
      document.documentElement.setAttribute("data-theme", current === "dark" ? "light" : "dark");
    }

    async function exportPDF() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();
      doc.text("EMI Calculation", 20, 20);
      doc.text(emiText.innerText, 20, 40);
      doc.text(interestText.innerText, 20, 50);
      doc.text(paymentText.innerText, 20, 60);
      doc.save("emi-details.pdf");
    }

    function sendEmail() {
      const body = `${emiText.innerText}\n${interestText.innerText}\n${paymentText.innerText}`;
      const mailto = `mailto:?subject=Your EMI Details&body=${encodeURIComponent(body)}`;
      window.location.href = mailto;
    }

    function compareLoans() {
      const [l1, l2] = [document.getElementById("l1").value, document.getElementById("l2").value];
      const [p1, r1, n1] = l1.split(",").map(Number);
      const [p2, r2, n2] = l2.split(",").map(Number);
      if ([p1, r1, n1, p2, r2, n2].some(isNaN)) return alert("Please enter valid values");
      const [e1, i1, t1] = calculateEMI(p1, r1, n1);
      const [e2, i2, t2] = calculateEMI(p2, r2, n2);
      document.getElementById("comparisonResults").innerHTML =
        `<p><strong>Loan 1 EMI:</strong> Rs. ${e1.toFixed(2)} | Interest: Rs. ${i1.toFixed(2)}</p>` +
        `<p><strong>Loan 2 EMI:</strong> Rs. ${e2.toFixed(2)} | Interest: Rs. ${i2.toFixed(2)}</p>`;
    }

    let chart;
    function updateChart(total, principal) {
      const ctx = document.getElementById("breakdownChart").getContext("2d");
      if (chart) chart.destroy();
      chart = new Chart(ctx, {
        type: "doughnut",
        data: {
          labels: ["Principal", "Interest"],
          datasets: [{
            data: [principal, total - principal],
            backgroundColor: ["#007bff", "#ffc107"]
          }]
        },
        options: {
          plugins: {
            legend: {
              position: "bottom"
            }
          }
        }
      });
    }

    window.onload = updateEMI;
  </script></body>
</html>
